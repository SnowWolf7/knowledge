## 9 排序

排序在软件系统设计中占有相当重要的地位，特别是在事务处理系统中，需要经常对有关的数据排序，以便提高检索等操作的效率。

### 9.1 基础知识

排序的稳定性：一般，不稳定的排序方法效率比较高、稳定的排序方法效率比较低。

内排序和外排序：根据排序过程中数据元素是否都在内存中，排序分为两大类：内排序和外排序。内排序是外排序的基础。

排序的效率：排序的效率可从时间复杂度和空间复杂度。时间复杂度可从排序过程中数据元素之间关键字的比较次数与数据元素的移动次数来衡量，一般取平均时间复杂度。

按时间复杂度来分，排序方法可以分为三类：简单排序，时间复杂度为$O(n^2)$; 快速排序，时间复杂度为$O(nlogn)$; 基数排序，时间复杂度为$O(d*n)$。

按排序方法分，排序方法可分为静态排序和动态排序。静态排序对数据元素进行物理重排，这时数据元素一般存放在顺序表中；动态排序不改变数据元素的物理位置，每个元素增加一个链接指针。

### 9.2 交换排序

交换排序的基本思想：是对排序表中的数据元素按关键字进行两两比较，如果发生逆序，则交换位置。例如：*冒泡排序*和*快速排序*。

**冒泡排序**

基本思想：

**快速排序**

基本思想：通过一趟排序将要排序的数组分成两个独立的部分：分割点左边都是比它小的数，分割点右边都是比它大的数。然后再按此方法对两部分数据分别进行快速排序，整个排序过程可以递归进行，以达到整个数组变成有序序列。

![](../图/quick_sort_partition_animation.gif)

### 9.3 插入排序

插入排序的基本思想是：每一次设法把一个数据元素插入到已经排序的部分序列的合适位置，使得插入后的序列仍然是有序的。开始时建立一个初始的有序序列，它只包含一个数据元素。然后，从这个初始序列出发不断插入数据元素，直到最后一个数据元素插入到有序序列后，整个排序工作就完成了。在有序序列中寻找插入位置有许多不同的方法，根据寻找插入位置方法的不同，有多种不同的插入排序方法。典型的有*直接插入排序*、*折半插入排序*、*希尔排序*。

### 9.4 选择排序

选择排序的基本思想是：第一趟在有$n$个数据元素的排序表中选出关键字最小的数据元素，然后在$n-1$个数据元素中再选取关键字最小的数据元素，依次重复，每一趟选出当前剩下的$n-i+1$ 个待排序数据元素中选出关键字最小的数据元素，作为有序数据元素序列的第$i$个数据元素。等到$n-1$趟选择结束，就得到有序序列，排序完成。典型的有*直接选择排序*、*锦标赛排序*、*堆排序*。

### 9.5 归并排序

所谓归并，就是将两个或两个以上的有序表合并成一个新的有序表。

两路归并的基本思想：设有两个有序表A和B，其数据元素个数（表长）分别为$n$和$m$， 变量$i$和$j$分别是表A和B的当前检测指针；设有表C是归并后的新有序表，变量$k$是它的当前存放指针。开始时$i,j,k$ 都分别指向A、B、C三个表的起始位置；然后根据A[i]与B[j]的关键字大小，把关键字小的数据元素放到新表C[k]中；且相应的检测指针(i或j)和存放指针k增加1.如此循环，当$i$或$j$中有一个已经超出表长时，将另一个表中的剩余部分照抄到新表C[k]~C[m+n]中。

两路归并排序就是利用两路归并算法进行排序，基本思想是：假设初始排序表有n个数据元素，首先把它看成是长度为1的首尾相接的n个有序子表（以后称它们为归并项），先做两两归并，得[n/2]个长度为2的归并项（如果n为奇数，则最后一个归并项的长度为1）；再做两两归并，...，如此重复，最后得到一个长度为n的有序序列。

### 9.6 基数排序

### 9.7 各种排序方法的选择和使用

在选择排序算法时，主要考虑一下因素：

1. 排序表的大小
2. 关键字的分布情况
3. 对排序稳定性的要求

考虑上述因素，提出下列建议：

1. 若排序表长度较小 $(n < 50)$, 可采用简单排序方法，如直接插入排序和直接选择排序。但是要注意直接插入排序的数据元素移动次数比直接选择排序的次数多，因此当数据元素个数较多的时候，直接选择排序会更好一点。
2. 若排序表的长度较大，应选用执行时间与$nlog_2n$成正比的排序方法，如快速排序、希尔排序、堆排序和归并排序等。当排序表中数据元素的关键字分布随机时，快速排序的平均运行时间最少；堆排序只需一个记录的辅助空间，并不会出现快速排序可能出现的最坏情况；希尔排序由于也是一种插入排序，故排序过程中移动记录的次数较多，但当纪录接近有序时，希尔排序较快。以上三种排序都是不稳定的。利用归并排序可以满足稳定性的要求。还可将归并排序和直接插入排序联合使用，即先用直接插入排序得到长度小于50的有序段，然后两两归并。
3. 若待排序纪录已基本有序，可采用直接插入排序方法或冒泡排序。
4. 当$n$很大而关键字位数较少时，可考虑采用基数排序方法。